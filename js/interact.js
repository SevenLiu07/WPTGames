function close_pop(){var e=$("#close_em_pop"),n=$("#close_info");e&&e.on("click",function(){$("#dialog_em").close(),window.location.href=baseUrls+"game-flash.html"}),n&&n.on("click",function(){dialog_info.close(),window.location.href=baseUrls+"game-flash.html"})}function rsaEncrypto(e){var n=null,a=cookie.getItem("cryptowpt");if(a&&3==a.split(":").length){var o=new RSAKeyPair(a.split(":")[2],"",a.split(":")[1],1024);n=encryptedString(o,base64encode(strUnicode2Ansi(e)),RSAAPP.PKCS1Padding)}else{var t=baseUrl+"Passport/GetCryptoToken";new Request(t,{method:"GET",maxTime:8e3,sync:!0}).on("complete",function(a){if(200==a.status){var o=JSON.parse(a.text);1==o.State&&(n=rsaEncrypto(e))}}).send()}return n}function top_nav(){var e={version:Math.random()},n=baseUrl+"Passport/GetLoginUserInfo";new Request(n,{method:"GET"}).on("complete",function(e){var n=JSON.parse(e.text);if(1==n.State)if(1==n.Value.IsLogined){var a=n.Value.DefaultDisplayName,o=n.Value.Email,t=n.Value.UId,l=cookie.getItem("clubfbGoldTipFlag"+t);l&&($("#dialog_clubuser").open(),$("#info_club").innerHTML=n.Message,$("#lets_play").on("click",function(){window.location.href=baseUrls+"game.html"}));var i="clubfbGoldTipFlag"+t;cookie.removeItem(i,{domain:".playwpt.com"});var s=cookie.getItem("tooLowGoldPlayerfbGoldTipFlag"+t);s&&($("#dialog_clubuser").open(),$("#info_club").innerHTML=n.Message,$("#lets_play").on("click",function(){window.location.href=baseUrls+"game.html"}));var r="tooLowGoldPlayerfbGoldTipFlag"+t;if(cookie.removeItem(r,{domain:".playwpt.com"}),0==n.Value.IsBindLz)$("#dialog_head").open(),$("#show_name").style.display="block",$("#show_head").style.display="none";else if(0==n.Value.IsBindAvatar)$("#dialog_head").open(),$("#show_name").style.display="none",$("#show_head").style.display="block";else if("ToValidate"==n.Value.UserStatus){$("#dialog_head").close(),$("#dialog_mail").open(),$("#vali_email").innerHTML=n.Message;var m=$("#dialog_mail");1==m.isOpen&&$("#dialog").close(),change_mail(o)}else $("#dialog_head").close(),$("#dialog_mail").close();$("#nav_login_after").style.display="block",$("#user_name").innerHTML=n.Value.LzDisplayName||n.Value.DefaultDisplayName,$("#nav_login_befor").style.display="none";var c=n.Value.LzDisplayName;localStorage.setItem("lz_name",c),$("#ipt_name").value=a,$("#log_out").on("click",function(){logout()}),$("#play_now").off("click"),$("#play_now").on("click",function(){0==n.Value.IsBindLz?($("#dialog_head").open(),$("#show_name").style.display="block",$("#show_head").style.display="none"):0==n.Value.IsBindAvatar?($("#dialog_head").open(),$("#show_name").style.display="none",$("#show_head").style.display="block"):window.location.href=baseUrls+"game.html"}),$("#btn_deal").off("click"),$("#btn_deal").on("click",function(){0==n.Value.IsBindLz?($("#dialog_head").open(),$("#show_name").style.display="block",$("#show_head").style.display="none"):0==n.Value.IsBindAvatar?($("#dialog_head").open(),$("#show_name").style.display="none",$("#show_head").style.display="block"):window.location.href=baseUrls+"game.html"}),$("#slots").off("click"),$("#slots").on("click",function(){0==n.Value.IsBindLz?($("#dialog_head").open(),$("#show_name").style.display="block",$("#show_head").style.display="none"):0==n.Value.IsBindAvatar?($("#dialog_head").open(),$("#show_name").style.display="none",$("#show_head").style.display="block"):window.location.href=baseUrls+"game_slot.html"})}else $("#nav_login_after").style.display="none",$("#nav_login_befor").style.display="block",open_pop(),$("#play_now").on("click",function(){$("#dialog").open(),$("#re_href_login").src=baseUrls+"login.html?nexturl="+baseUrls+"game.html"}),$("#btn_deal").on("click",function(){$("#dialog").open(),$("#re_href_login").src=baseUrls+"login.html?nexturl="+baseUrls+"game.html"}),$("#slots").on("click",function(){$("#dialog").open(),$("#re_href_login").src=baseUrls+"login.html?nexturl="+baseUrls+"game_slot.html"});else n.State==-2e3&&($("#dialog_ip").open(),$("#info_ip").innerHTML=n.Message)}).send(e)}function login(){var e=document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("userEmail").value,n=document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("pwd1"),a=rsaEncrypto(n.value),o=document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("error_msg"),t=(document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("yzm"),"none"==document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("yzm").style.display?null:document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("catpchaCode").value),l="none"==document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("yzm").style.display?null:document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("captchaToken").value,i={version:Math.random(),email:e,pwd:a,catpchaCode:t,captchaToken:l},s=baseUrl+"Login/WebLogin";new Request(s,{method:"POST"}).on("complete",function(n){var a=JSON.parse(n.text);if(1==a.State){if(0==a.Value.IsBindLz)$("#dialog_head").open(),$("#show_name").style.display="block",$("#show_head").style.display="none";else if(0==a.Value.IsBindAvatar)$("#dialog_head").open(),$("#show_name").style.display="none",$("#show_head").style.display="block";else if(1==a.Value.IsOldClubWPTPlayerAndExchangedGold)$("#dialog_clubuser").open(),$("#info_club").innerHTML=a.Message,$("#lets_play").on("click",function(){window.location.href=baseUrls+"game.html"});else if(1==a.Value.IsAddedGoldForTooLowGoldPlayer)$("#dialog_clubuser").open(),$("#info_club").innerHTML=a.Message,$("#lets_play").on("click",function(){window.location.href=baseUrls+"game.html"});else{var t=a.Value.LzDisplayName;localStorage.setItem("lz_name",t),$("#user_name").innerHTML=a.Value.LzDisplayName||a.Value.DefaultDisplayName;var l=document.getElementsByTagName("iframe")[0].contentWindow.location.parameters.nexturl;null!=l&&""!=l&&(window.location.href=l)}$("#dialog").close();var i=document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("check_em");1==i.checked?localStorage.setItem("emial_user",e):localStorage.setItem("emial_user",""),top_nav()}else if(3==a.State){$("#dialog").close(),$("#dialog_mc").open(),title_m.innerHTML="Validate Email Notice";var s="";s+="You need to validate your email before logging in.<br>Note: Please check your spam filter if you have not received the validation email.",$("#m_info").innerHTML=s,vili_email.style.display="block",play_gm.style.display="none",v_mail=1==e.contains("@gmail.com")?'<a target="_blank" href="https://mail.google.com/"></a>':1==e.contains("@outlook.com")?'<a target="_blank" href="https://www.outlook.com/"></a>':1==e.contains("@hotmail.com")?'<a target="_blank" href="https://www.hotmail.com/"></a>':1==e.contains("@yahoo.com")?'<a target="_blank" href="https://www.yahoo.com/"></a>':'<a href="javascript:void (0)"></a>',vali_btn.innerHTML=v_mail,$("#vali_btn").off("click"),$("#vali_btn").on("click",function(){$("#time").style.display="block",vali_btn.innerHTML="",vali_btn.hasClass("vali_btn_gray")||(vali_Resend(),time=setInterval(function(){time_djs()},1e3)),vali_btn.addClass("vali_btn_gray")})}else 21!=a.State&&(window.frames[0].reloadCaptcha(),document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("catpchaCode").value=""),o.innerHTML=a.Message}).send(i)}function vali_Resend(){var e={version:Math.random()},n=baseUrl+"Passport/ToValidateEmail";new Request(n,{method:"POST"}).on("complete",function(e){var n=JSON.parse(e.text);1==n.State}).send(e)}function time_djs(){getWaitTime--,$("#time").innerHTML=getWaitTime,getWaitTime<=0&&(getWaitTime=120,clearInterval(time),vali_btn.innerHTML=v_mail,$("#time").style.display="none",vali_btn.removeClass("vali_btn_gray"))}function resend_tm(){getTime--,$("#re_time").innerHTML=getTime,getTime<=0&&(getTime=120,clearInterval(time_rs),$("#re_time").style.display="none",$("#re_time").innerHTML="",yz_mail.removeClass("djs"))}function regist(){var e=document.getElementsByTagName("iframe")[1].contentWindow.document.getElementById("email").value,n=document.getElementsByTagName("iframe")[1].contentWindow.document.getElementById("password"),a=rsaEncrypto(n.value),o=document.getElementsByTagName("iframe")[1].contentWindow.document.getElementById("error_mess"),t=(document.getElementsByTagName("iframe")[1].contentWindow.document.getElementById("yzm_reg"),"none"==document.getElementsByTagName("iframe")[1].contentWindow.document.getElementById("yzm_reg").style.display?null:document.getElementsByTagName("iframe")[1].contentWindow.document.getElementById("catpchaCode_reg").value),l="none"==document.getElementsByTagName("iframe")[1].contentWindow.document.getElementById("yzm_reg").style.display?null:document.getElementsByTagName("iframe")[1].contentWindow.document.getElementById("captchaToken_reg").value,i={version:Math.random(),email:e,pwd:a,promotion:!0,catpchaCode:t,captchaToken:l},s=baseUrl+"Passport/WebRegister";new Request(s,{method:"POST"}).on("complete",function(n){var a=JSON.parse(n.text);if(1==a.State)regist_url.indexOf("signup")!=-1&&(window.location.href=baseUrls+"game-flash.html"),$("#dialog").close(),top_nav(),change_mail(e),ga("send","event","Signup","Register","E-mail"),window.google_trackConversion({google_conversion_id:864698956,google_conversion_label:conversionLabels.em,google_remarketing_only:!1});else if(a.State==-100)setTimeout(function(){$("#signa").className="",$("#logina").className="login_hv",$("#login_con").morph({right:0},{duration:500,timingFunction:"linear"}),$("#sign_con").morph({left:0},{duration:500,timingFunction:"linear"});var n=document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("userEmail");n.value=e;var a=document.getElementsByTagName("iframe")[0].contentWindow.document.getElementById("error_msg");a.innerHTML="An account with your email has already been registered. If you forgot your password, please click on Forgot Password below to reset your password."},2e3);else if(21!=a.State&&(window.frames[1].reloadCaptcha_reg(),document.getElementsByTagName("iframe")[1].contentWindow.document.getElementById("catpchaCode_reg").value=""),o.innerHTML=a.Message,null!=o.innerHTML||""!=o.innerHTML){var t=document.getElementsByTagName("iframe")[1].contentWindow.document.getElementById("div_email");t.className="rMainDecide ie6png rMainDecide_err",document.getElementsByTagName("iframe")[1].contentWindow.document.getElementById("SubmitMark").value=0}}).send(i)}function open_pop(){$("#login").on("click",function(){$("#signa").className="",$("#logina").className="login_hv",$("#dialog").open(),$("#re_href_login").src=baseUrls+"login.html?nexturl="+baseUrls+"game.html",$("#login_con").morph({right:0},{duration:0,timingFunction:"linear"}),$("#sign_con").morph({left:0},{duration:0,timingFunction:"linear"}),preventScroll("dialog")}),$("#sign").on("click",function(){$("#sign_con").style.display="block",$("#signa").className="sign_hv",$("#logina").className="",$("#dialog").open(),$("#sign_con").morph({left:-390},{duration:0,timingFunction:"linear"}),$("#login_con").morph({right:390},{duration:0,timingFunction:"linear"}),preventScroll("dialog")}),sign_up.on("click",function(){$("#sign_con").style.display="block",$("#signa").className="sign_hv",$("#logina").className="",$("#sign_con").morph({left:-390},{duration:500,timingFunction:"linear"}),$("#login_con").morph({right:390},{duration:500,timingFunction:"linear"})}),log.on("click",function(){$("#signa").className="",$("#logina").className="login_hv",$("#login_con").morph({right:0},{duration:500,timingFunction:"linear"}),$("#sign_con").morph({left:0},{duration:500,timingFunction:"linear"})})}function bindName(){var e=$("#ipt_name").value,n={version:Math.random(),roleName:e},a=baseUrl+"Passport/BindLzRoleName";new Request(a,{method:"POST"}).on("complete",function(e){var n=JSON.parse(e.text);1==n.State?(ga("send","event","Signup","Entered","Username"),window.google_trackConversion({google_conversion_id:864698956,google_conversion_label:conversionLabels.ue,google_remarketing_only:!1}),$("#show_name").style.display="none",$("#show_head").style.display="block"):$("#worn_name").innerHTML=n.Message}).send(n)}function bindAvatar(){if(1==sex){var e="1001";ga("send","event","Signup","Avatar","M"),window.google_trackConversion({google_conversion_id:864698956,google_conversion_label:conversionLabels.as,google_remarketing_only:!1})}else{var e="2001";ga("send","event","Signup","Avatar","F"),window.google_trackConversion({google_conversion_id:864698956,google_conversion_label:conversionLabels.as,google_remarketing_only:!1})}var n={version:Math.random(),sex:sex,avatarCode:e},a=baseUrl+"Passport/BindAvatar";new Request(a,{method:"POST"}).on("complete",function(e){var n=JSON.parse(e.text);1==n.State?top_nav():$("#worn_name").innerHTML=n.Message}).send(n)}function head(){for(var e=$("#chose_head").findAll("a"),n=$("#chose_head").findAll(".active_icon"),a=0;a<e.length;a++)e[a].on("click",function(){for(var a=0;a<e.length;a++)e[a].removeClass("active_head"),n[a].style.display="none",this.find(".active_icon").style.display="block",this.addClass("active_head"),sex=this.id})}function validateEmail(){var e={version:Math.random()},n=baseUrl+"Passport/ToValidateEmail";new Request(n,{method:"POST"}).on("complete",function(e){var n=JSON.parse(e.text);1==n.State||console.log(n.Message)}).send(e)}function logout(){var e={version:Math.random()},n=baseUrl+"Login/WebLogout";new Request(n,{method:"GET"}).on("complete",function(e){var n=JSON.parse(e.text);1==n.State&&($("#nav_login_after").style.display="none",$("#nav_login_befor").style.display="block",open_pop(),window.location.href=baseUrls+"game-flash.html")}).send(e)}function change_mail(e){var n=document.getElementById("pic_mail");1==e.contains("@gmail.com")?(n.style.backgroundImage="url(image/mail_gm.png)",n.innerHTML='<a target="_blank" href="https://mail.google.com/"></a>'):1==e.contains("@outlook.com")?(n.style.backgroundImage="url(image/mail_ol.png)",n.innerHTML='<a target="_blank" href="https://www.outlook.com/"></a>'):1==e.contains("@hotmail.com")?(n.style.backgroundImage="url(image/mail_hm.png)",n.innerHTML='<a target="_blank" href="https://www.hotmail.com/"></a>'):1==e.contains("@yahoo.com")?(n.style.backgroundImage="url(image/mail_yh.png)",n.innerHTML='<a target="_blank" href="https://www.yahoo.com/"></a>'):n.style.backgroundImage="url(image/deft.png)"}function funPlaceholder(e){var n="";if(e&&!("placeholder"in document.createElement("input"))&&(n=e.getAttribute("placeholder"))){var a=e.id;a||(a="placeholder_"+(new Date).getTime(),e.id=a);var o=document.createElement("label");o.htmlFor=a,o.style.position="absolute",o.style.top="10px",o.style.left=0,o.style.margin="7px 0 7px 10px",o.style.color="gray",o.style.fontSize="12px",o.style.lineHeight="26px",o.style.cursor="text",e.parentNode.insertBefore(o,e),e.onkeydown=function(){o.innerHTML=""},e.addEventListener("input",function(){o.innerHTML=""},!1),e.onblur=function(){""===this.value&&(o.innerHTML=n)},""===e.value&&(o.innerHTML=n)}}cookie.setItem("timezone",(new Date).getTimezoneOffset()/60*-1);var sign_up=$("#sign_up"),log=$("#log"),sex=1,man=$("#man"),woman=$("#woman"),dialog_info=$("#dialog_info"),titles=$("#titles"),title_m=$("#title_m"),info_tips=$("#info_tips"),qd_btn=$("#qd_btn"),fg_pwd_btn=$("#fg_pwd_btn"),next_oldclub=$("#next_oldclub"),m_dis=$("#m_dis"),h_title=$("#h_title"),vili_email=$("#vili_email"),vali_btn=$("#vali_btn"),play_gm=$("#play_gm"),resend=$("#resend"),http_type=location.protocol+"//",lHost=window.location.host,getHost=lHost.substring(4),baseUrl=http_type+"napi."+getHost+"/WebAPI/",baseUrls=http_type+location.host+"/",regist_url=window.location.href,conversionLabels={as:"iIUfCJqZ7G0QzISpnAM",ue:"QXcECK7C0m0QzISpnAM",fb:"BsikCKvC0m0QzISpnAM",em:"rvKdCMzw5m0QzISpnAM"};window.onload=function(){var e=document.getElementsByTagName("iframe")[2].contentWindow.document.getElementById("changePwd"),n=document.getElementsByTagName("iframe")[2].contentWindow.document.getElementById("sendEmail");if(location.parameters.step||0==location.parameters.step?11!=location.parameters.step&&location.parameters.step!=-11&&12!=location.parameters.step&&location.parameters.step!=-12&&0!=location.parameters.step||$("#dialog_head").close():top_nav(),12==location.parameters.step){var a=document.getElementsByTagName("iframe")[2].contentWindow.document.getElementById("users_mail"),o=document.getElementsByTagName("iframe")[2].contentWindow.document.getElementById("cg_pwd");1==location.parameters.isOldClubWPTPlayerAndCanExchangeGold?($("#dialog_em").open(),$("#dialog_mail").close(),e.style.display="block",o.innerHTML="Welcome!",a.innerHTML="As a loyal ClubWPT member, we have a PlayWPT account waiting for you. Create a password to get started.",n.style.display="none"):($("#dialog_em").open(),$("#dialog_mail").close(),o.innerHTML="Change Password",e.style.display="block",a.innerHTML="Current Email<br>"+decodeURIComponent(window.parent.location.parameters.email),n.style.display="none"),close_pop()}else if(location.parameters.step==-12){dialog_info.open();var t="";titles.innerHTML="Change Password",t+='The password changing link has expired. Please click "Forget Password" button to reset the password',info_tips.innerHTML=t,qd_btn.style.display="none",fg_pwd_btn.style.display="block",next_oldclub.style.display="none",close_pop()}else if(location.parameters.step==-11){var l=decodeURIComponent(location.parameters.email);$("#dialog_mc").open(),title_m.innerHTML="Validate Email Notice",$("#m_info").innerHTML="The validation link has already expired. Please validate email right now.",vili_email.style.display="block",play_gm.style.display="none",v_mail=1==l.contains("@gmail.com")?'<a target="_blank" href="https://mail.google.com/"></a>':1==l.contains("@outlook.com")?'<a target="_blank" href="https://www.outlook.com/"></a>':1==l.contains("@hotmail.com")?'<a target="_blank" href="https://www.hotmail.com/"></a>':1==l.contains("@yahoo.com")?'<a target="_blank" href="https://www.yahoo.com/"></a>':'<a href="javascript:void (0)"></a>',vali_btn.innerHTML=v_mail,$("#vali_btn").off("click"),$("#vali_btn").on("click",function(){$("#time").style.display="block",vali_btn.innerHTML="",vali_btn.hasClass("vali_btn_gray")||(vali_Resend(),time=setInterval(function(){time_djs()},1e3)),vali_btn.addClass("vali_btn_gray")}),close_pop()}else if(0==location.parameters.step||11==location.parameters.step){dialog_info.open();var i="";i+=decodeURIComponent(location.parameters.title),titles.innerHTML=i;var s="";s+=decodeURIComponent(location.parameters.msg),info_tips.innerHTML=s,title_m.innerHTML=s,qd_btn.style.display="block",fg_pwd_btn.style.display="none",next_oldclub.style.display="none",close_pop()}else if(regist_url.indexOf("signup")!=-1){$("#sign_con").style.display="block",$("#signa").className="sign_hv",$("#logina").className="",$("#dialog").open(),$("#re_href_login").src=baseUrls+"login.html?nexturl="+baseUrls+"game.html",$("#sign_con").morph({left:-390},{duration:0,timingFunction:"linear"}),$("#login_con").morph({right:390},{duration:0,timingFunction:"linear"}),preventScroll("dialog");var r=document.getElementsByTagName("iframe")[1].contentWindow.document.getElementById("email");""!=location.parameters.email&&"null"!=location.parameters.email&&void 0!=location.parameters.email&&(r.value=location.parameters.email)}},next_oldclub&&next_oldclub.on("click",function(){window.location.href=baseUrls+"game-flash.html",top_nav()});var v_mail="",e_info_btn=$("#e_info_btn");e_info_btn&&e_info_btn.on("click",function(){dialog_info.close(),parent.window.location.href=baseUrls+"game-flash.html"});var time,getWaitTime=120,time_rs,getTime=120,yz_mail=$("#yz_mail");yz_mail.off("click"),yz_mail.on("click",function(){$("#re_time").style.display="block",yz_mail.hasClass("djs")||(validateEmail(),time_rs=setInterval(function(){resend_tm()},1e3)),yz_mail.addClass("djs")}),$("#btn_next").on("click",function(){var e=$("#ipt_name"),n=$("#worn_name");""==e.value?n.innerHTML="Please input your username":e.value.indexOf(" ")>=0?n.innerHTML="Sorry, your Username cannot contain space":e.value.replace(/[^\x00-\xff]/g,"xx").length<4?n.innerHTML="Your username is too short, please input 4-20 characters as your username":e.value.replace(/[^\x00-\xff]/g,"xx").length>20?n.innerHTML="Your username is too long, please input 4-20 characters as your username":bindName()}),$("#start_gm").on("click",function(){bindAvatar()}),head(),play_gm.on("click",function(){$("#dialog_mc").close(),setTimeout(function(){window.location.href=baseUrls+"game-flash.html"},0)});