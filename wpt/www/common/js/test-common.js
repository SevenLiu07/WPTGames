require(["../../model/inventory-model"],function(e){var a=avalon.define("inventory",function(t){t.baseData=["avatars","charms","emojis","items","tickets"],t.items=!1,t.tickets=!1,t.charms=!1,t.emojis=!1,t.avatars=!0,t.avatarDataIndex="",t.charmDataIndex="",t.navIndex="",t.currentEmojisClass="emojis_01",t.showEmojis01=!0,t.showEmojis02=!1,t.avatarsData=[],t.bigAvatarUrl="",t.charmsData=[],t.smallCharmUrl="",t.emojisData01=[],t.emojisData02=[],t.bigEmojisUrl="",t.itemsData=[],t.ticketsData=[];var o={version:Math.random()};t.init=function(){t.tabClick(),t.renderAvatarsInfo(),t.renderCharmsInfo(),t.renderTicketsInfo(),t.renderEmojisInfo(),t.renderItemsInfo()},t.renderAvatarsInfo=function(){e.getAvatarList(o,function(e){if(e.Value){var o=e.Value;if(o&&o.length){for(var n=0;n<o.length;n++)o[n].IsCurrentAvatar&&(a.avatarDataIndex=n,a.bigAvatarUrl=o[n].BigAvatarUrl);a.avatarsData=o,t.scrollBar("avatars")}}},function(e){},function(e){})},t.renderCharmsInfo=function(){e.getCharmList(o,function(e){if(e.Value){var t=JSON.parse(e.Value)[9];if(t&&t.length){for(var o=0;o<t.length;o++)t[o].selected&&(a.charmDataIndex=o,a.smallCharmUrl=t[o].url);a.charmsData=t}}},function(e){},function(e){})},t.renderTicketsInfo=function(){e.getTicketList(o,function(e){if(e.Value){var t=JSON.parse(e.Value)[4],o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(t&&t.length){for(var n=0;n<t.length;n++){var r=PLAY.parseDate(t[n].validTime),i=o[r.getMonth()],s=r.getFullYear(),l=r.getDate()>10?r.getDate():"0"+r.getDate();t[n].validTime=i+"."+l+"."+s}a.ticketsData=t}}},function(e){},function(e){})},t.renderItemsInfo=function(){e.getItemList(o,function(e){if(e.Value){var t=JSON.parse(e.Value)[8];t&&t.length&&(a.itemsData=t)}},function(e){},function(e){})},t.renderEmojisInfo=function(){var e=[{AvatarId:29,SmallEmojisUrl:"../inventory/images/74x76.gif",BigEmojisUrl:"../inventory/images/74x76.gif",IsCurrentAvatar:!0,UserId:5,RoleName:"tanhongsing",LzAccount:"w~43128689181594316",CreatedOnUtc:"2016-06-13 02:29:42",CreatedOnBias:480},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.gif",BigEmojisUrl:"../inventory/images/test74x76.gif",IsCurrentAvatar:!0,UserId:6,CreatedOnBias:480}],t=[{AvatarId:29,SmallEmojisUrl:"../inventory/images/test22274x76.png",BigEmojisUrl:"../inventory/images/test22274x76.png",IsCurrentAvatar:!0,UserId:5,CreatedOnBias:480},{AvatarId:29,AvatarCode:"1006",AvatarName:"1006",SmallEmojisUrl:"../inventory/images/test22274x76.png",BigEmojisUrl:"../inventory/images/test22274x76.png",IsCurrentAvatar:!0,UserId:6,CreatedOnBias:480},{AvatarId:29,AvatarCode:"1006",AvatarName:"1006",SmallEmojisUrl:"../inventory/images/test22274x76.png",BigEmojisUrl:"../inventory/images/test22274x76.png",IsCurrentAvatar:!0,UserId:5,CreatedOnBias:480},{AvatarId:29,AvatarCode:"1006",AvatarName:"1006",SmallEmojisUrl:"../inventory/images/test22274x76.png",BigEmojisUrl:"../inventory/images/test22274x76.png",IsCurrentAvatar:!0,UserId:6,CreatedOnBias:480},{AvatarId:29,AvatarCode:"1006",AvatarName:"1006",SmallEmojisUrl:"../inventory/images/test22274x76.png",BigEmojisUrl:"../inventory/images/test22274x76.png",IsCurrentAvatar:!0,UserId:5,CreatedOnBias:480},{AvatarId:29,AvatarCode:"1006",AvatarName:"1006",SmallEmojisUrl:"../inventory/images/test22274x76.png",BigEmojisUrl:"../inventory/images/test22274x76.png",IsCurrentAvatar:!0,UserId:6,CreatedOnBias:480}];a.emojisData01=e,a.emojisData02=t},t.clickAvatars=function(o){t.avatarDataIndex=o;var n={version:Math.random(),avatarCode:""},r=a.avatarsData;if(r&&r.length)for(var i=0;i<r.length;i++)i===o&&(a.bigAvatarUrl=r[i].BigAvatarUrl,n.avatarCode=r[i].AvatarCode,e.setCurrentAvatar(n,function(e){avalon.vmodels.loginInfo.getUserInfo()},function(e){},function(e){}))},t.clickCharm=function(o){t.charmDataIndex=o;var n=a.charmsData,r={version:Math.random(),itemID:"",isSelect:!0};if(n&&n.length)for(var i=0;i<n.length;i++)i===o&&(a.smallCharmUrl=n[i].url,r.itemID=n[i].itemId,e.selectCharm(r,function(e){},function(e){},function(e){}))},t.tabEmojis=function(e){a.showEmojis01=!1,a.showEmojis02=!1,t.currentEmojisClass=e,"emojis_01"===e?a.showEmojis01=!0:a.showEmojis02=!0,t.scrollBar("emojis")},t.clickEmojis01=function(e){for(var t=a.emojisData01,o=0;o<t.length;o++)o===e&&(a.bigEmojisUrl=t[o].BigEmojisUrl)},t.clickEmojis02=function(e){for(var t=a.emojisData02,o=0;o<t.length;o++)o===e&&(a.bigEmojisUrl=t[o].BigEmojisUrl)},t.tabClick=function(e,a){for(var o=t.baseData,n=0;n<o.length;n++)t[o[n]]=!1;t.navIndex=e,t[a]=!0,t.scrollBar(a)},t.styleHandle=function(e,a){var t={emojis:{showScroll:function(){e.css("paddingLeft","33px"),a.css("marginRight","35px")},hideScroll:function(){e.css("paddingLeft","50px"),a.css("marginRight","35px")}},charms:{showScroll:function(){e.css("paddingLeft","20px"),a.css("marginRight","12px")},hideScroll:function(){e.css("paddingLeft","25px"),a.css("marginRight","4%")}},avatars:{showScroll:function(){e.css("paddingLeft","20px"),a.css("marginRight","12px")},hideScroll:function(){e.css("paddingLeft","25px"),a.css("marginRight","4%")}},items:{showScroll:function(){e.css("paddingLeft","16px"),a.css("marginRight","45px")},hideScroll:function(){e.css("paddingLeft","17px"),a.css("marginRight","56px")}},tickets:{showScroll:function(){return!1},hideScroll:function(){return!1}}};return t},t.scrollBar=function(e){if(e){var a=$("#"+e),o=a.find(".scroll-pane");o.scrollBar({scrollbarWidth:37,scrollbarMargin:0,arrowHeight:78});var n=a.find(".scrollBarTrack"),r=o.find("li");n.length?t.styleHandle(o,r)[e].showScroll():t.styleHandle(o,r)[e].hideScroll()}},t.showStore=function(e){avalon.vmodels.show_inventory.toggle=!1,avalon.vmodels.store.showShopDialog("show_store",e,"items")},t.openDialog={title:"title_inventory",modal:"inventory",width:"1016px",onOpen:function(){t.init()},onConfirm:function(){},onClose:function(){}},t.show=function(e,a){avalon.vmodels[e].toggle=!0,a&&(avalon.vmodels.show_store.toggle=!1,avalon.vmodels.show_single_buy.toggle=!1,avalon.vmodels.show_info.toggle=!1,t.tabClick(t.baseData.indexOf(a),a))}});avalon.scan()}),require(["../../../www/model/pay-model"],function(e){var a="",t="",o="",n="",r="",i="",s="",l="",c="",m="",u="",d="",g="",f=/^\d{16}$/,h=/^[0-9]*$/,v={},p=avalon.define({$id:"payment",pay_option:!0,billing_info:!1,complet_order:!1,error_msg:"",error_billing_msg:"",notice_msg:"",info_name:"",info_address:"",info_city:"",info_state:"",info_postal:"",info_country:"",product_name:"",order_price:"",btn_ok:!1,btn_retry:!1,btn_success:!1,init:function(){p.pay_option=!0,p.billing_info=!1,p.complet_order=!1,p.error_msg="",p.error_billing_msg="",p.notice_msg="",p.info_name="",p.info_address="",p.info_city="",p.info_state="",p.info_postal="",p.info_country="",p.product_name="",p.order_price=""},backto_card:function(){p.pay_option=!0,p.billing_info=!1,p.complet_order=!1},backto_billing:function(){p.pay_option=!1,p.billing_info=!0,p.complet_order=!1},check_payinfo:function(){return!!p.check_credit()&&(""==v.exp_date.val()||null==v.exp_date.val()?(p.error_msg="Please enter a valid expiry date.",v.exp_date.focus(),!1):!!p.check_expriat()&&(null==v.ccv.val()||""==v.ccv.val()?(p.error_msg="Please input the CVV.",v.ccv.focus(),!1):!h.test(v.ccv.val())||v.ccv.val().length<3?(p.error_msg="CVV2 is a three or four digit value which is printed on the back of your credit card.",v.ccv.focus(),!1):(p.error_msg="",p.pay_option=!1,p.billing_info=!0,p.complet_order=!1,void 0)))},check_credit:function(){return null==v.card_num.val()||""==v.card_num.val()?(p.error_msg="Please input the Credit Card Number.",v.card_num.focus(),!1):v.card_num.val().indexOf(" ")>=0?(p.error_msg="Sorry,Credit card number cannot consist of space.",v.card_num.focus(),!1):!(1==v.is_base_card&&!f.test(v.card_num.val())||v.card_num.val().length<16)||(p.error_msg="Credit card number must be 16 digits value.",v.card_num.focus(),!1)},check_expriat:function(){var e=new Date,a=e.getFullYear(),t=e.getMonth()+1,o=["01","02","03","04","05","06","07","08","09","10","11","12"],n=["16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"];t<10&&(t="0"+t);var r=a+""+t,i=r.substr(2,2),s=r.substr(4,2),l=v.exp_date.val().substr(2,2),c=v.exp_date.val().substr(0,2),m=c+""+l;t=m.substr(0,2),a=m.substr(2,2);var u=$.inArray(t,o),d=$.inArray(a,n);return 4!=m.length?(p.error_msg="The expiry date must be 4 digits.",v.exp_date.focus(),!1):u==-1||d==-1?(p.error_msg="Please enter a valid expiry date.",v.exp_date.focus(),!1):l<i?(p.error_msg="Please enter a valid expiry date.",v.exp_date.focus(),!1):l==i&&c<s?(p.error_msg="Please enter a valid expiry date.",v.exp_date.focus(),!1):(p.error_msg=" ",!0)},check_billing:function(){return""==v.firstname.val()||null==v.firstname.val()?(p.error_billing_msg="Please enter your first name.",v.firstname.focus(),!1):v.firstname.val().indexOf(" ")>=0?(p.error_billing_msg="Sorry, your first name cannot contain space.",v.firstname.focus(),!1):""==v.lastname.val()||null==v.lastname.val()?(p.error_billing_msg="Please enter your last name.",v.lastname.focus(),!1):v.lastname.val().indexOf(" ")>=0?(p.error_billing_msg="Sorry, your last name cannot contain space.",v.lastname.focus(),!1):""==v.street.val()||null==v.street.val()?(p.error_billing_msg="Please input your street.",v.street.focus(),!1):""==v.city.val()||null==v.city.val()?(p.error_billing_msg="Please enter your city.",v.city.focus(),!1):""==v.state.val()||null==v.state.val()?(p.error_billing_msg="Please enter your state/province.",v.state.focus(),!1):v.state.val().indexOf(" ")>=0?(p.error_billing_msg="Sorry, your state cannot contain space.",v.state.focus(),!1):p.check_pos_code()?(p.error_billing_msg="",p.info_name=v.firstname.val()+" "+v.middlename.val()+" "+v.lastname.val(),p.info_address=v.street.val(),p.info_city=v.city.val(),p.info_state=v.state.val(),p.info_postal=v.pos_input.val(),p.info_country=$("#country option:selected").text(),p.pay_option=!1,p.billing_info=!1,p.complet_order=!0,void 0):(console.log("postal code 不通过"),!1)},check_pos_code:function(){return""==v.pos_input.val()||null==v.pos_input.val()?(p.error_billing_msg="Please input your Postal Code.",v.pos_input.focus(),!1):v.pos_input.val().indexOf(" ")>=0?(p.error_billing_msg="Sorry, Postal code cannot contain space.",v.pos_input.focus(),!1):!(!h.test(v.pos_input.val())||v.pos_input.val().length<4)||(p.error_billing_msg="Postal code must be 4-6 digits value.",v.pos_input.focus(),!1)},gPaymentInfo:function(){var f=$("#show_infos");e.getPaymentInfo({version:Math.random(),paymsgid:l,timestamp:c,quantity:u,md5sign:d},function(e){if(m=e.TimeStamp,d=e.MD5Sign,t=e.PlatformPayMessageEO.PlatformId,o=e.PlatformPayMessageEO.UId,n=e.PlatformPayMessageEO.PlatformOrderCode,r=e.PlatformPayMessageEO.TbProductId,i=e.PlatformPayMessageEO.TbProductName,s=e.PlatformPayMessageEO.OrderPrice,g=e.ValidNum,p.product_name=e.PlatformPayMessageEO.TbProductName+" x "+u,p.order_price="$"+e.PlatformPayMessageEO.OrderPrice/100,a=e.BankcardModel.BankcardNum,null!=a&&""!=a){var l=a.substr(a.length-4);v.card_num.val("************"+l)}v.exp_date.val(e.BankcardModel.ExpDate),null!=v.card_num.val()&&""!=v.card_num.val()?(f.show(),f.removeClass("reduce_info"),v.card_num.attr("disabled",!0),f.off("click"),f.click(function(){0==v.is_base_card?v.is_base_card=1:v.is_base_card=0,f.hasClass("reduce_info")?(f.toggleClass("reduce_info"),v.card_num.val("************"+l),v.exp_date.val(e.BankcardModel.ExpDate),v.card_num.attr("disabled",!0)):(f.toggleClass("reduce_info"),v.card_num.attr("disabled",!1),v.card_num.focus(),v.card_num.val(""),v.exp_date.val(""))})):f.hide();var c=e.BillInfoModel.ContactName;if(null!=c&&""!=c){var h=c.split("-");v.firstname.val(h[0]),v.middlename.val(h[1]),v.lastname.val(h[2])}v.street.val(e.BillInfoModel.AddressLine),v.city.val(e.BillInfoModel.City),v.state.val(e.BillInfoModel.State),v.pos_input.val(e.BillInfoModel.Zip);var w=e.BillInfoModel.Country;null!=w&&""!=w&&$("#country").val(w)},function(e){p.error_msg=e.Message},function(e){p.error_msg=e.Message})},comfirmOrder:function(){var c=v.firstname.val(),f=v.middlename.val(),h=v.lastname.val(),w=c+"-"+f+"-"+h,_=v.street.val(),y=v.state.val(),b=v.pos_input.val(),I=v.city.val(),C=v.country.val(),M=1,E="";E=0==v.is_base_card?a:v.card_num.val();var P=v.exp_date.val(),x=v.ccv.val();e.confirmOrder(!0,{version:Math.random(),quantity:u,platformid:t,userid:o,ordercode:n,productid:r,productname:i,productprice:s,paymsgid:l,timestamp:m,validnum:g,md5sign:d,contactname:w,addressline:_,state:y,zip:b,city:I,country:C,cardtype:M,cardnum:E,cardexpdate:P,cardvalidnum:x},function(e){e.Value;p.show("show_notice"),p.notice_msg="You have successfully purchased "+i+". Good luck! ",p.btn_ok=!1,p.btn_retry=!1,p.btn_success=!0},function(e){e&&e.Message&&(e==-4?(p.show("show_notice"),p.notice_msg="You have not acted in time. Payment failed. Please try again later.",p.btn_ok=!0,p.btn_retry=!1,p.btn_success=!1):(p.show("show_notice"),p.notice_msg="Payment failed. No charges were made. Please try again later.",p.btn_ok=!0,p.btn_retry=!1,p.btn_success=!1))},function(e,a){a&&a.Message?(p.show("show_notice"),p.notice_msg="Payment failed. No charges were made. Please try again later.",p.btn_ok=!1,p.btn_success=!1,p.btn_retry=!0):"timeout"==e&&(p.show("show_notice"),p.notice_msg="PlayWPT will process your order as quick as possible. If you does not get feeback after one day, Please contact us at support@playwtp.com Thanks for your patience.",p.btn_ok=!0,p.btn_retry=!1,p.btn_success=!1)})},$payment:{title:"title_payment",showClose:!0,width:"747px",smallDialog:!0,onOpen:function(e){return l=e.data.paymsgid,c=e.data.timestamp,u=e.data.quantity,d=e.data.md5sign,p.gPaymentInfo(),$(".doubt").mouseover(function(){$(".tips").show(200)}).mouseout(function(){$(".tips").hide(200)}),v.is_base_card=0,v.card_num=$("input[name='card_num']"),v.exp_date=$("input[name='ex_date']"),v.ccv=$("input[name='ccv']"),v.firstname=$("input[name='firstname']"),v.middlename=$("input[name='middlename']"),v.lastname=$("input[name='lastname']"),v.street=$("input[name='street']"),v.city=$("#pay_city"),v.state=$("#pay_state"),v.pos_input=$("input[name='postalCode']"),v.country=$("#country"),v},onConfirm:function(){},onClose:function(){a="",t="",o="",n="",r="",i="",s="",l="",c="",m="",u="",d="",g="",v.is_base_card=0,v.card_num.val(""),v.exp_date.val(""),v.ccv.val(""),v.firstname.val(""),v.middlename.val(""),v.lastname.val(""),v.street.val(""),v.city.val(""),v.state.val(""),v.pos_input.val(""),v.country.val("USA"),p.init()}},$notice:{title:"title_notice",showClose:!0,modal:!0,width:"530px",smallDialog:!0,onOpen:function(){},onConfirm:function(){},onClose:function(){}},show:function(e){avalon.vmodels[e].toggle=!0},hidden:function(e,a){avalon.vmodels[e].toggle=!1,a&&(avalon.vmodels[a].toggle=!1)}})}),require(["../../model/store-model"],function(e){var a=avalon.define("store",function(t){t.baseData=["gold","items"],t.baseData2=["avatars","charms","emojis","other"],t.gold=!1,t.silver=!1,t.items=!0,t.avatars=!0,t.charms=!1,t.emojis=!1,t.other=!1,t.smallNavIndex=0,t.bigNavIndex="",t.currentEmojisClass="emojis_01",t.goldData=[],t.avatarsData=[],t.bigAvatarUrl="",t.charmsData=[],t.smallCharmUrl="",t.currentSmallCharmUrl="",t.storeCharmsDialog=!1,t.storeCharmsDialogIndex=0,t.emojisData=[],t.smallEmojisData=[],t.otherData=[],t.bigEmojisUrl="",t.itemData=[],t.gameId=25011,t.currentItemData={PicPath:"",Name:"",Descr:"",Price:"",GoodsCode:""},t.currentItemType="",t.messageInfo="",t.createOrderSucHref="",t.messageOtherInfo=!1,t.showStoreBtn=!1,t.batchBuyNumber=1,t.batchBuyTotalPrice=0,t.queryPriceData={};var o={version:Math.random()};t.init=function(){},t.renderGoldInfo=function(){var o={version:Math.random(),gameId:t.gameId,menuCode:"menu_gold"};e.getGoodsListByMenu(o,function(e){if(e.Value){var o=e.Value;o.DataList&&o.DataList.length&&(a.goldData=o.DataList,t.scrollBar("gold"))}},function(e){},function(e){})},t.renderAvatarsInfo=function(){var o={version:Math.random(),gameId:t.gameId,menuCode:"menu_avatars"};e.getGoodsListByMenu(o,function(e){if(e.Value){var o=e.Value;o.DataList&&o.DataList.length&&(a.avatarsData=o.DataList,t.scrollBar("avatars"))}},function(e){},function(e){})},t.renderCharmsInfo=function(){var o={version:Math.random(),gameId:t.gameId,menuCode:"menu_poker_charms"};e.getGoodsListByMenu(o,function(e){if(e.Value){var o=e.Value;o.DataList&&o.DataList.length&&(a.charmsData=o.DataList,t.scrollBar("charms"))}},function(e){},function(e){})},t.renderEmojisInfo=function(){var o={version:Math.random(),gameId:t.gameId,menuCode:"menu_emoji"};e.getGoodsListByMenu(o,function(e){if(e.Value){var o=e.Value;o.DataList&&o.DataList.length&&(a.emojisData=o.DataList,t.scrollBar("emojis"))}},function(e){},function(e){})},t.renderOtherInfo=function(){var o={version:Math.random(),gameId:t.gameId,menuCode:"menu_other"};e.getGoodsListByMenu(o,function(e){if(e.Value){var o=e.Value;o.DataList&&o.DataList.length&&(a.otherData=o.DataList,t.scrollBar("other"))}},function(e){},function(e){})},t.bigTabClick=function(e,o){t.closeStoreCharmsDialog();for(var n=t.baseData,r=0;r<n.length;r++)a[n[r]]=!1;a.bigNavIndex=e,a[o]=!0,"items"===o?(t.smallTabClick(t.baseData2.indexOf("avatars"),"avatars"),t.scrollBar("avatars")):(a.goldData.length<=0&&t.renderGoldInfo(),t.scrollBar(o))},t.smallTabClick=function(e,o){t.closeStoreCharmsDialog();for(var n=t.baseData2,r=0;r<n.length;r++)a[n[r]]=!1;a.smallNavIndex=e;var i=PLAY.initiaToLowerCase(o),s=o+"Data";a[s].length<=0&&t["render"+i+"Info"](),a.bigAvatarUrl||t.renderSmallDialogAvatars(),a[o]=!0,t.scrollBar(o)},t.scrollBar=function(e){if(e){var a=$("#store_"+e);a.scrollBar({showArrows:!0,horizontalBar:!0}),a.find(".item").find(".hover_bg").length&&a.find(".item").hover(function(){$(this).find(".hover_bg").show()},function(){$(this).find(".hover_bg").hide()})}},t.styleHandle=function(e,a){var t={emojis:{showScroll:function(){e.css("paddingLeft","33px"),a.css("marginRight","32px")},hideScroll:function(){e.css("paddingLeft","36px"),a.css("marginRight","37px")}}};return t},t.scrollBar2=function(e,a){if(e){var o=$("."+e),n=o.find(".scroll-pane");n.scrollBar({scrollbarWidth:37,scrollbarMargin:0,arrowHeight:78,scrollbarOnLeftAdjust:a});var r=o.find(".scrollBarTrack"),i=n.find("li");r.length?t.styleHandle(n,i).emojis.showScroll():t.styleHandle(n,i).emojis.hideScroll()}},t.clickEmojis=function(e){for(var t=a.smallEmojisData,o=0;o<t.length;o++)o===e&&(a.bigEmojisUrl=t[o].BigEmojisUrl)},t.renderSmallDialogAvatars=function(){e.getAvatarList(o,function(e){if(e.Value){var t=e.Value;if(t&&t.length)for(var o=0;o<t.length;o++)t[o].IsCurrentAvatar&&(a.bigAvatarUrl=t[o].BigAvatarUrl)}},function(e){},function(e){})},t.renderSmallDialogCharms=function(){e.getCharmList(o,function(e){if(e.Value){var t=JSON.parse(e.Value)[9];if(t&&t.length)for(var o=0;o<t.length;o++)t[o].selected&&(a.smallCharmUrl=t[o].url)}},function(e){},function(e){})},t.renderSmallEmojisInfo=function(){var e=[{AvatarId:29,SmallEmojisUrl:"../inventory/images/74x76.png",BigEmojisUrl:"../inventory/images/137x139.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0},{AvatarId:29,SmallEmojisUrl:"../inventory/images/test74x76.png",BigEmojisUrl:"../inventory/images/test74x76.png",IsCurrentAvatar:!0}];a.smallEmojisData=e,t.scrollBar2("store_show_emojis",!0)},t.openDialog={title:"title_store",modal:"store",width:"1016px",onOpen:function(){t.init()},onConfirm:function(){},onClose:function(){}},t.openEmojisDialog={title:"title_emojis",modal:!1,width:"747px",smallDialog:!0,onOpen:function(){a.smallCharmUrl||t.renderSmallDialogCharms(),a.smallEmojisData.length<=0&&t.renderSmallEmojisInfo()},onConfirm:function(){},onClose:function(){}},t.openCharmsDialog=function(e,t){var o=parseInt($("body").width()/2),n=parseInt(o+$(e.target).closest(".item").width());e.clientX<o?a.storeCharmsDialogIndex=0:e.clientX>o&&e.clientX<n?a.storeCharmsDialogIndex=1:e.clientX>n&&(a.storeCharmsDialogIndex=2),a.currentSmallCharmUrl=t,a.storeCharmsDialog=!0},t.closeStoreCharmsDialog=function(){a.storeCharmsDialog=!1},t.openSingleBuyDialog={title:"title_single_buy",modal:!0,width:"530px",smallDialog:!0,onOpen:function(){},onConfirm:function(){},onClose:function(){a.currentItemData.PicPath=null}},t.showBuy=function(o,n,r){t.setCurrentItemData(o,n,r);var i={version:Math.random(),gameId:t.gameId,goodsCode:n.GoodsCode};e.queryPrice(i,function(e){e.Value&&(a.queryPriceData=e.Value)},function(e){e&&e.Message&&(a.messageInfo=e.Message,avalon.vmodels.show_info.toggle=!0)},function(e){e&&e.Message&&(a.messageInfo=e.Message,avalon.vmodels.show_info.toggle=!0)})},t.setCurrentItemData=function(e,t,o){a.currentItemType=o,t&&(a.currentItemData.GoodsCode=t.GoodsCode,a.currentItemData.PicPath=t.PicPath,a.currentItemData.Name=t.Name,a.currentItemData.Descr=t.Descr,a.currentItemData.Price=t.Price,a.batchBuyTotalPrice=PLAY.toDecimal2(t.Price)),avalon.vmodels[e].toggle=!0},t.openBatchBuyDialog={title:"title_batch_buy",modal:!0,width:"530px",smallDialog:!0,onOpen:function(){},onConfirm:function(){},onClose:function(){a.batchBuyNumber=1,a.currentItemData.PicPath=null}},t.openPublicShowInfo={title:"title_showInfo",modal:!0,width:"530px",smallDialog:!0,onOpen:function(){a.showStoreBtn=!1,"Sorry,you do not have enough gold"==a.messageInfo&&(a.showStoreBtn=!0)},onConfirm:function(){"Sorry,you do not have enough gold"==a.messageInfo&&(avalon.vmodels.show_single_buy.toggle=!1,avalon.vmodels.show_batch_buy.toggle=!1,t.bigTabClick(t.baseData.indexOf("gold"),"gold"))},onClose:function(){a.messageOtherInfo=!1}},t.confirmSingleBuy=function(e){var o=a.queryPriceData;o.IsBalancePay&&!o.IsAfford?(a.messageInfo="Sorry,you do not have enough gold",avalon.vmodels.show_info.toggle=!0):t.createSingleBuyOrder(e)},t.batchBuyMinus=function(){a.batchBuyNumber>=2&&(a.batchBuyNumber--,a.currentItemData&&a.currentItemData.Price&&(a.batchBuyTotalPrice=PLAY.toDecimal2(parseFloat(a.currentItemData.Price*a.batchBuyNumber))))},t.batchBuyInput=function(){0===a.batchBuyNumber?a.batchBuyNumber=1:a.batchBuyNumber>9&&(a.batchBuyNumber=parseInt(a.batchBuyNumber.toString().substring(0,1))),a.currentItemData&&a.currentItemData.Price&&(a.batchBuyTotalPrice=PLAY.toDecimal2(parseFloat(a.currentItemData.Price*a.batchBuyNumber)))},t.batchBuyBlur=function(){0!==a.batchBuyNumber&&a.batchBuyNumber||(a.batchBuyNumber=1),a.currentItemData&&a.currentItemData.Price&&(a.batchBuyTotalPrice=PLAY.toDecimal2(parseFloat(a.currentItemData.Price*a.batchBuyNumber)))},t.batchBuyAdd=function(){a.batchBuyNumber++,a.batchBuyNumber>9&&(a.batchBuyNumber=9),a.currentItemData&&a.currentItemData.Price&&(a.batchBuyTotalPrice=PLAY.toDecimal2(parseFloat(a.currentItemData.Price*a.batchBuyNumber)))},t.confirmBatchBuy=function(e){var o=a.queryPriceData;o.IsBalancePay&&!o.IsAfford?(a.messageInfo="Sorry,you do not have enough gold",avalon.vmodels.show_info.toggle=!0):t.createBatchBuyOrder(e)},t.showPayment=function(e){var t={quantity:a.batchBuyNumber,paymsgid:e.PayMsgID||"",timestamp:e.TimeStamp||"",md5sign:e.MD5Sign||""};t&&(avalon.vmodels.show_payment.data=t,avalon.vmodels.show_batch_buy.toggle=!1,avalon.vmodels.show_payment.toggle=!0)},t.createBatchBuyOrder=function(o){var n={version:Math.random(),gameId:t.gameId,goodsCode:o,quantity:a.batchBuyNumber};e.createOrder(n,function(e){if(e.Value){var o=e.Value;10===o.OrderStatus?(a.messageInfo=o.SuccessMessage,avalon.vmodels.show_info.toggle=!0):o.IsBalancePay?o.IsAfford?(a.messageInfo=e.Message,avalon.vmodels.show_info.toggle=!0):(a.messageInfo="Sorry,you do not have enough gold",avalon.vmodels.show_info.toggle=!0):t.showPayment(o)}},function(e){21===e.State?a.messageInfo="Sorry,you do not have enough gold":e.Message&&(a.messageInfo=e.Message),avalon.vmodels.show_info.toggle=!0},function(e){e&&e.Message&&(a.messageInfo=e.Message,avalon.vmodels.show_info.toggle=!0)})},t.createSingleBuyOrder=function(o){var n={version:Math.random(),gameId:t.gameId,goodsCode:o};e.createOrder(n,function(e){if(e.Value){var o=e.Value;o&&o.RechargeUrl?t.showPayment(o):(10===o.OrderStatus?(a.messageInfo="Purchase successful.",a.messageOtherInfo=!0):o.IsBalancePay&&!o.IsAfford?a.messageInfo="Sorry,you do not have enough gold":a.messageInfo=e.Message,avalon.vmodels.show_info.toggle=!0)}},function(e){21===e.State?a.messageInfo="Sorry,you do not have enough gold":e.Message&&(a.messageInfo=e.Message),avalon.vmodels.show_info.toggle=!0},function(e){e&&e.Message&&(a.messageInfo=e.Message,avalon.vmodels.show_info.toggle=!0)})},t.showShopDialog=function(e,a,o){avalon.vmodels[e].toggle=!0,t.bigTabClick(t.baseData.indexOf(o),o),a&&t.smallTabClick(t.baseData2.indexOf(a),a)},t.showInventory=function(e){avalon.vmodels.inventory.show(e,a.currentItemType)},t.show=function(e){avalon.vmodels[e].toggle=!0}});avalon.scan()}),require(["../../model/promotion-model"],function(e){var a=avalon.define("promotion",function(t){t.messageOtherInfo=!1,t.message="",t.GoldData=[],t.TicketData=[],t.AwardaData=[],t.baseData=["submit_btn","promotion"];({version:Math.random()});t.submit_btn=function(){function e(){var e=location.search,a=new Object;if(e.indexOf("?")!=-1){var t=e.substr(1);if(t.indexOf("&")!=-1){strs=t.split("&");for(var o=0;o<strs.length;o++)a[strs[o].split("=")[0]]=unescape(strs[o].split("=")[1])}else{var n=t.substring(0,t.indexOf("=")),r=t.substr(t.indexOf("=")+1);a[n]=decodeURI(r)}}return a}t.hide("show_promotion"),a.megsuccessIfo=!0;var o=e().id,n=$("#code_num").val();t.renderSubmitInfo(n,o)},t.init=function(){},t.renderSubmitInfo=function(t,o){void 0==o?parame={type:1,promoCode:t}:parame={type:0,promoId:o},e.getItemCode(parame,function(e){if(1==e.State){for(var t=e.Value,o=[],n=[],r=[],i=0;i<t.length;i++)1==t[i].AwdId?o.push(t[i]):2==t[i].AwdId?n.push(t[i]):3==t[i].AwdId&&r.push(t[i]);a.GoldData=o,a.TicketData=n,a.AwardaData=r,!function(){var e=0,a=$(".slider-panel").width(),t=$("#show-area").find("li").size(),o=$("#width_ul"),n=o.find("li").length;o.width(a*n),$(".staic_numb").html("/"+t),$("#coun_number").html(e+1),$("#button-left").click(function(){0!=e&&(e--,o.animate({marginLeft:-e*a},500))}),$("#button-right").click(function(){if(n-1!=e){e++;var t=$("#width_ul").find("li").eq(e).find("#coun_number");t&&t.html(e+1),o.animate({marginLeft:-e*a},500)}})}(),avalon.vmodels.show_reddommSuc.toggle=!0}},function(e){var t=e.Message;a.message=t,avalon.vmodels.show_reddommNotice.toggle=!0},function(e){})};({version:Math.random()});t.openDialog={title:"title_promotion",modal:"promotion",smallDialog:!0,width:"747px",onOpen:function(){t.init()},onConfirm:function(){},onClose:function(){}},t.hide=function(e){avalon.vmodels[e].toggle=!1},t.show=function(e){avalon.vmodels[e].toggle=!0}});avalon.scan()}),require(["../../model/account-model"],function(e){var a=avalon.define("register",function(t){t.email="",t.password="",t.errorMsg="",t.showErrorMsg=!1,t.showCaptcha=!1,t.captchaSrc="",t.captchaVal="",t.captchaToken="",t.inputUsername="Enter username",t.sex=1,t.currentEmailClass="",t.currentEmailHref="javascript:void(0)",t.time=120,t.showTime=!1,t.validateEmailMessage="To get started,please validate your email and we will give you 1,000 Gold to start playing.Validating your email will also unlock your free lucky spin.";var o={version:Math.random()};t.showPlayGamesBtn=!1,t.publicMessageTitle="",t.publicMessageCon="",t.facebookRegisterHref="javascript:void(0)",t.initRegister=function(){if(location.href.indexOf("signup")!==-1&&(PLAY.url.getQuery()&&PLAY.url.getQuery().email&&(a.email=PLAY.url.getQuery().email),t.show("show_register")),PLAY.url.getQuery()&&PLAY.url.getQuery().step){var e=PLAY.url.getQuery(),o=e.step;o==-11?(a.publicMessageCon="The validation link has already expired. Please validate email right now.",a.publicMessageTitle="Validate Email Notice",a.showPlayGamesBtn=!0,t.show("show_validateEmailError")):0!=o&&11!=o||(a.publicMessageTitle=e.title,a.publicMessageCon=e.msg,t.show("show_validateEmailSuc"))}else t.userInfoHandle()},t.userInfoHandle=function(){var e=PLAY.userInfo;if(e){var o=e.Value;1===e.State&&o&&o.IsLogined&&(o.IsBindLz?o.IsBindAvatar?"ToValidate"===o.UserStatus&&(a.validateEmailMessage=o.Message,a.email=o.Email,a.inputUsername=o.LzDisplayName,t.show("show_validateEmail")):t.show("show_selectAvatar"):t.show("show_createUsername"))}},t.initRegisterDialog=function(){t.showCaptchaWhenRegister(),t.facebookRegister()},t.inputFocus=function(e){this.getAttribute("placeholder")===e&&this.setAttribute("placeholder","")},t.captchaBlur=function(){""===a.captchaVal.trim()&&this.setAttribute&&this.setAttribute("placeholder","Captcha")},t.emailBlur=function(){a.email.indexOf("")!==-1&&(a.email=a.email.replace(/[ ]/g,""));var e=PLAY.checkEmail(a.email.trim(),function(e){a.errorMsg=e});return""===a.email.trim()&&this.setAttribute&&this.setAttribute("placeholder","Email"),e?(a.showErrorMsg=!1,!0):(a.showErrorMsg=!0,!1)},t.passwordBlur=function(){var e=PLAY.checkPassword(a.password.trim(),6,16,function(e){a.errorMsg=e});return""===a.password.trim()&&this.setAttribute&&this.setAttribute("placeholder","Password"),e?(a.showErrorMsg=!1,!0):(a.showErrorMsg=!0,!1)},t.reloadCaptcha=function(){e.getCaptchaToken({},function(e){if(e.Value){var t=e.Value;t&&(a.showCaptcha=!0,a.captchaToken=t,a.captchaSrc=PLAY.baseUrl+"WebAPI/page/Captcha/GenerateCaptchaImg?time="+(new Date).getTime()+"&token="+t)}},function(e){},function(e){})},t.showCaptchaWhenRegister=function(){e.showCaptchaWhenRegister({},function(e){if(e){var o=e.Value;o&&1===o?(a.showCaptcha=!0,t.reloadCaptcha()):a.showCaptcha=!1}},function(e){},function(e){})},t.rsaEncrypto=function(){var o=PLAY.rsaEncrypto(a.password);return o?o:void e.getCryptoToken({},function(e){if(e.Value){var a=e.Value;a&&(o=t.rsaEncrypto())}},function(e){},function(e){})},t.webRegister=function(){var o=t.emailBlur();if(o){var n=t.passwordBlur();if(n){var r=t.rsaEncrypto(),i={version:Math.random(),email:a.email,pwd:r,promotion:!0,catpchaCode:a.captchaVal,captchaToken:a.captchaToken};e.webRegister(i,function(e){
e&&(avalon.vmodels.loginInfo.getUserInfo(),t.hide("show_register"),t.show("show_createUsername"))},function(e){21!==e.State?(t.reloadCaptcha(),a.captchaVal="",a.errorMsg=e.Message,a.showErrorMsg=!0):(a.errorMsg=e.Message,a.showErrorMsg=!0,a.showCaptcha=!0)},function(e){a.errorMsg=e.Message,a.showErrorMsg=!0})}}},t.selectSex=function(e){a.sex=e},t.inputUsernameFocus=function(){"Enter username"===a.inputUsername&&(a.inputUsername=""),this.style.color="#fff"},t.inputUsernameBlur=function(){""===a.inputUsername.trim()?(a.inputUsername="Enter username",this.style.color="#6d7186"):this.style.color="#fff"},t.changeEmailBtn=function(){var e=a.email;e.indexOf("@gmail.com")!==-1?(a.currentEmailClass="gmail",a.currentEmailHref="https://mail.google.com/"):e.indexOf("@outlook.com")!==-1?(a.currentEmailClass="outlook",a.currentEmailHref="https://www.outlook.com/"):e.indexOf("@hotmail.com")!==-1?(a.currentEmailClass="hotmail",a.currentEmailHref="https://www.hotmail.com/"):e.indexOf("@yahoo.com")!==-1&&(a.currentEmailClass="yahoo",a.currentEmailHref="https://www.yahoo.com/")},t.facebookRegister=function(){var t={version:Math.random()};e.getFacebookLoginEntranceURL(t,function(e){e.Value&&e.Value.RedirectUrl&&(a.facebookRegisterHref=e.Value.RedirectUrl)},function(e){a.errorMsg=e.Message,a.showErrorMsg=!0},function(e){a.errorMsg=e.Message,a.showErrorMsg=!0})},t.selectAvatar=function(){var o=a.inputUsername,n="";if(""===o)n="Please input your username";else if(o.indexOf(" ")>=0)n="Sorry, your Username cannot contain space";else if(o.replace(/[^\x00-\xff]/g,"xx").length<4)n="Your username is too short, please input 4-20 characters as your username";else if(o.replace(/[^\x00-\xff]/g,"xx").length>20)n="Your username is too long, please input 4-20 characters as your username";else{var r={version:Math.random(),roleName:o};e.bindLzRoleName(r,function(e){e&&(avalon.vmodels.loginInfo.getUserInfo(),t.hide("show_createUsername"),t.show("show_selectAvatar"))},function(e){a.errorMsg=e.Message,a.showErrorMsg=!0},function(e){a.errorMsg=e.Message,a.showErrorMsg=!0})}n&&(a.errorMsg=n,a.showErrorMsg=!0)},t.countDown=function(){1===a.time?(clearInterval(t.countDownInterval),a.showTime=!1,a.time=120):a.time--},t.resendEmail=function(){a.showTime||(a.showTime=!0,t.countDownInterval=setInterval(t.countDown,1e3),e.toValidateEmail(o,function(e){},function(e){console.log(e.Message)},function(e){console.log(e.Message)}))},t.openRegisterDialog={title:"title_register",modal:!0,width:"968px",smallDialog:!0,onOpen:function(){t.initRegisterDialog()},onConfirm:function(){},onClose:function(){}},t.openSelectAvatarDialog={title:"title_selectAvatar",modal:!0,width:"833px",smallDialog:!0,onOpen:function(){},onConfirm:function(){var o="";o=1===a.sex?"1001":"2001";var n={version:Math.random(),sex:a.sex,avatarCode:o};e.bindAvatar(n,function(e){e&&(t.hide("show_selectAvatar"),t.show("show_validateEmail"))},function(e){a.errorMsg=e.Message,a.showErrorMsg=!0},function(e){a.errorMsg=e.Message,a.showErrorMsg=!0})},onClose:function(){}},t.openCreateUsernameDialog={title:"title_username",modal:!0,width:"833px",smallDialog:!0,onOpen:function(){a.errorMsg=""},onConfirm:function(){},onClose:function(){}},t.openValidateEmailDialog={title:"title_validateEmail",modal:!0,width:"903px",smallDialog:!0,onOpen:function(){t.changeEmailBtn()},onConfirm:function(){},onClose:function(){PLAY.url.getQuery()&&PLAY.url.getQuery().step&&(location.href=PLAY.baseUrl+"wpt/www/module/index/index.html")}},t.openValidateEmailSucDialog={title:"title_validateEmailSuc",modal:!0,width:"833px",smallDialog:!0,onOpen:function(){},onConfirm:function(){location.href=PLAY.baseUrl+"wpt/www/module/poker/index.html"},onClose:function(){}},t.openValidateEmailErrorDialog={title:"title_validateEmailError",modal:!0,width:"833px",smallDialog:!0,onOpen:function(){},onConfirm:function(){},onClose:function(){}},t.openPublicMessageDialog={title:"title_publicMessage",modal:!0,width:"833px",smallDialog:!0,onOpen:function(){},onConfirm:function(){location.href=PLAY.baseUrl+"wpt/www/module/poker/index.html"},onClose:function(){}},t.hide=function(e){avalon.vmodels[e].toggle=!1},t.show=function(e){avalon.vmodels[e].toggle=!0}});avalon.scan(),a.initRegister();var t=0,o=avalon.define({$id:"login",email:"",pwd:"",hasCaptchaImage:!1,captchaVal:"",showCaptcha:!1,catpchaCode:"",captchaToken:"",captchaSrc:"",errorMsg:"",showErrorMsg:!1,facebookLoginHref:"javascript:void(0)",user_email:"",showEmailMsg:!1,showPwdMsg:!0,errorMsgEmail:"",errorMsgPwd:"",send_mail:!0,send_mail_info:!1,change_pwd:!1,change_pwd_title:"",current_email:"",newpwd:"",confirm_newpwd:"",pwdMsg:"",outTimeMsg:"",showTime:!1,time:120,publicMessageTitle:"",publicMessageCon:"",initLogin:function(){if(PLAY.url.getQuery()&&PLAY.url.getQuery().step){var e=PLAY.url.getQuery(),a=e.step;12==a?(o.show("show_sendemail"),o.send_mail=!1,o.send_mail_info=!1,o.change_pwd=!0,o.change_pwd_title="Change Password",o.current_email=decodeURIComponent(e.email)):a==-12&&(o.show("show_resendemail"),o.outTimeMsg='The password changing link has expired. Please click "Forget Password" button to reset the password')}else avalon.vmodels.register.userInfoHandle()},emailFocus:function(){"Email"===this.getAttribute("placeholder")&&this.setAttribute("placeholder","")},passwordFocus:function(){"Password"===this.getAttribute("placeholder")&&this.setAttribute("placeholder","")},captchaFocus:function(){"Captcha"===this.getAttribute("placeholder")&&this.setAttribute("placeholder","")},emailBlur:function(){var e=PLAY.checkEmail(o.email.trim(),function(e){o.errorMsg=e});e?o.showErrorMsg=!1:o.showErrorMsg=!0,""===o.email.trim()&&this.setAttribute("placeholder","Email"),o.showCaptchaWhenLogin()},passwordBlur:function(){o.pwd?o.showErrorMsg=!1:(o.showErrorMsg=!0,o.errorMsg="Please input your password"),""===o.pwd.trim()&&this.setAttribute("placeholder","Password"),o.showCaptchaWhenLogin()},pwdFocus:function(e){"newpwd"==e?"New Password"===this.getAttribute("placeholder")&&this.setAttribute("placeholder",""):"confirm_newpwd"==e?"Confirm new password"===this.getAttribute("placeholder")&&this.setAttribute("placeholder",""):"useremail"==e&&"Please enter your e-mail"===this.getAttribute("placeholder")&&this.setAttribute("placeholder","")},pwdBlur:function(e){"newpwd"==e?""===o.newpwd.trim()&&this.setAttribute("placeholder","New Password"):"confirm_newpwd"==e?""===o.confirm_newpwd.trim()&&this.setAttribute("placeholder","Confirm new password"):"useremail"==e&&""===o.user_email.trim()&&this.setAttribute("placeholder","Please enter your e-mail")},catpchaBlur:function(){o.catpchaCode||(o.showErrorMsg=!0,o.errorMsg="Please input your catpchaCode"),""===o.catpchaCode.trim()&&this.setAttribute("placeholder","Captcha")},reloadCaptcha:function(){e.getCaptchaToken({},function(e){if(e.Value){var a=e.Value;a&&(o.hasCaptchaImage=!0,o.showCaptcha=!0,o.captchaToken=a,o.captchaSrc=PLAY.baseUrl+"WebAPI/page/Captcha/GenerateCaptchaImg?time="+(new Date).getTime()+"&token="+a)}},function(e){},function(e){})},showCaptchaWhenLogin:function(){var a=o.email;e.showCaptchaWhenLogin({email:a},function(e){if(e){var a=e.Value;a&&1===a?(o.showCaptcha=!0,o.hasCaptchaImage||o.reloadCaptcha()):o.showCaptcha=!1}},function(e){},function(e){})},rsaEncrypto:function(a){var t="";return"loginpwd"==a?t=PLAY.rsaEncrypto(o.pwd):"newpwd"==a?t=PLAY.rsaEncrypto(o.newpwd):"confirm_newpwd"==a&&(t=PLAY.rsaEncrypto(o.confirm_newpwd)),t?t:void e.getCryptoToken({},function(e){if(e.Value){var n=e.Value;n&&(t=o.rsaEncrypto(a))}},function(e){},function(e){})},userLogin:function(){o.showCaptchaWhenLogin();var e=PLAY.checkEmail(o.email.trim(),function(e){o.errorMsg=e});e?o.pwd?1!=o.showCaptcha||o.catpchaCode?o.login():(o.showErrorMsg=!0,o.errorMsg="Please input your catpchaCode"):(o.showErrorMsg=!0,o.errorMsg="Please input your password"):o.showErrorMsg=!0},login:function(){var a=o.rsaEncrypto("loginpwd");e.webLogin({vision:Math.random(),email:o.email,pwd:a,catpchaCode:o.catpchaCode,captchaToken:o.captchaToken},function(e){if(e){e.Value;o.hidden("show_login"),avalon.vmodels.loginInfo.getUserInfo()}},function(e){21!=e.State&&(o.reloadCaptcha(),o.captchaVal=""),3==e.State&&(o.hidden("show_login"),o.show("show_publicMessage"),o.publicMessageTitle="Validate Email Notice",o.publicMessageCon="You need to validate your email before logging in.Note: Please check your spam filter if you have not received the validation email."),o.showErrorMsg=!0,o.errorMsg=e.Message},function(e){o.showErrorMsg=!0,o.errorMsg=e.Message})},facebookLogin:function(){var a={version:Math.random()};e.getFacebookLoginEntranceURL(a,function(e){e.Value&&e.Value.RedirectUrl&&(o.facebookLoginHref=e.Value.RedirectUrl)},function(e){o.errorMsg=e.Message,o.showErrorMsg=!0},function(e){o.errorMsg=e.Message,o.showErrorMsg=!0})},sendEmail:function(){var e=PLAY.checkEmail(o.user_email.trim(),function(e){o.errorMsgEmail=e});e?(o.showEmailMsg=!1,o.toForgetPwd()):o.showEmailMsg=!0,""===o.user_email.trim()&&this.setAttribute("placeholder","Please enter your e-mail")},toForgetPwd:function(){var a="",t="";if(PLAY.url.getQuery()&&PLAY.url.getQuery().step){var n=PLAY.url.getQuery(),r=n.step;r==-12&&(a=decodeURIComponent(n.email))}else a=o.user_email;t=a.indexOf("@gmail.com")!==-1?'<a target="_blank" href="https://mail.google.com/">check your inbox</a>':a.indexOf("@outlook.com")!==-1?'<a target="_blank" href="https://www.outlook.com/">check your inbox</a>':a.indexOf("@hotmail.com")!==-1?'<a target="_blank" href="https://www.hotmail.com/">check your inbox</a>':a.indexOf("@yahoo.com")!==-1?'<a target="_blank" href="https://www.yahoo.com/">check your inbox</a>':"check your inbox",e.toForgetPassword({vision:Math.random(),email:a},function(e){e.Value;o.hidden("show_resendemail"),o.show("show_sendemail"),o.send_mail=!1,o.send_mail_info=!0,o.pwdMsg="We've sent a link to reset your password. Please "+t+" . The link will expire in one hour.",o.change_pwd=!1},function(e){o.showEmailMsg=!0,o.errorMsgEmail=e.Message},function(e){o.showEmailMsg=!0,o.errorMsgEmail=e.Message})},q_checkUPassword:function(){var e=PLAY.checkPassword(o.newpwd.trim(),6,16,function(e){o.errorMsgPwd=e});return e?(o.confirm_newpwd!=o.newpwd?o.errorMsgPwd="The password does not match. Please input again.":o.showPwdMsg=!1,!0):(o.showPwdMsg=!0,!1)},q_checkCPassword:function(){var e=PLAY.checkPassword(o.confirm_newpwd.trim(),6,16,function(e){o.errorMsgPwd=e});return e?o.newpwd!=o.confirm_newpwd?o.errorMsgPwd="The password does not match. Please input again.":o.showPwdMsg=!1:o.showPwdMsg=!0,!0},resetPwd:function(){var a=o.rsaEncrypto("newpwd"),n=o.rsaEncrypto("confirm_newpwd");e.resetPassword({version:Math.random(),pwd:a,pwd2:n},function(e){o.errorMsgPwd=e.Message,o.send_mail=!1,o.send_mail_info=!0,o.pwdMsg="Password successfully updated.",o.change_pwd=!1},function(e){return t=0,o.errorMsgPwd=e.Message,!1},function(e){return t=0,o.errorMsgPwd=e.Message,!1})},change_email:function(){var e="0",a=o.newpwd,n=o.confirm_newpwd;return"1"==t?(o.errorMsgPwd="Submitted. Please wait",e="1",!1):null==a||""==a?(o.errorMsgPwd="Your password must be 6-16 characters long. You can use numbers, letters, or symbols excluding ,;' ",e="1",!1):o.q_checkUPassword&&o.q_checkCPassword?a!=n?(o.q_checkUPassword(),o.q_checkCPassword(),e="1",!1):void("0"==e&&(t=1,o.resetPwd())):(e="1",!1)},countDown:function(){1===o.time?(clearInterval(o.countDownInterval),o.showTime=!1,o.time=120):o.time--},resendEmail:function(){o.showTime||(o.showTime=!0,o.countDownInterval=setInterval(o.countDown,1e3),e.toValidateEmail({version:Math.random()},function(e){},function(e){console.log(e.Message)},function(e){console.log(e.Message)}))},$login:{title:"title_register",modal:!0,width:"968px",smallDialog:!0,onOpen:function(){},onConfirm:function(){},onClose:function(){}},$pwd:{title:"",modal:!0,width:"903px",smallDialog:!0,onOpen:function(){},onConfirm:function(){},onClose:function(){}},show:function(e){avalon.vmodels[e].toggle=!0},hidden:function(e,a){avalon.vmodels[e].toggle=!1,a&&(avalon.vmodels[a].toggle=!1)}});avalon.scan(),o.initLogin()});